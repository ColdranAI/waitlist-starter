zerops:
  - setup: app
    build:
      base: nodejs@20
      envVariables:
        REDIS_URL: redis://redis:6379
        DATABASE_URL: ${db_connectionTlsString}
        NEXT_PUBLIC_TURNSTILE_SITE_KEY: 0x4AAAAAABmUsOaGja-PzTWf
        TURNSTILE_SECRET_KEY: 0x4AAAAAABmUsAvdqLCS8hWpQMxp5x3EXMA
        NEXT_PUBLIC_DISCORD_INVIE: https://discord.gg/vnReNt4J7T
        NODE_ENV: production
      buildCommands:
        - pnpm i
        - pnpm run build
        - pnpm db:migrate
      deployFiles: ./
    run: 
      base: nodejs@20
      envVariables:
        REDIS_URL: redis://redis:6379
        DATABASE_URL: ${db_connectionTlsString}
        NEXT_PUBLIC_TURNSTILE_SITE_KEY: 0x4AAAAAABmUsOaGja-PzTWf
        TURNSTILE_SECRET_KEY: 0x4AAAAAABmUsAvdqLCS8hWpQMxp5x3EXMA
        NEXT_PUBLIC_DISCORD_INVIE: https://discord.gg/vnReNt4J7T
        NODE_ENV: production
      ports:
        - port: 3000
          httpSupport: true
      start: pnpm run start
